%% typography.sty - Typography and Content Macros
%% Heidelberg Catechism Posters

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{typography}[2024/01/01 Illuminated Catechism Typography]

\RequirePackage{fontspec}
\RequirePackage{lettrine}
\RequirePackage{setspace}
\RequirePackage{microtype}

%% ============================================================
%% Widow/Orphan Control
%% ============================================================

\widowpenalty=10000
\clubpenalty=10000
\brokenpenalty=10000
\predisplaypenalty=10000
\postdisplaypenalty=10000
\displaywidowpenalty=10000
\interlinepenalty=150

%% ============================================================
%% Font Configuration (requires XeLaTeX/LuaLaTeX)
%% ============================================================

% Main body font - EB Garamond for readability with historical character
\setmainfont{EB Garamond}[
    Numbers=OldStyle,
    Ligatures=TeX
]

% Title font - Harbour Decor
\newfontfamily\titlefont{Harbour Decor}[
    Path=/Users/micahcooper/Library/Application Support/Adobe/CoreSync/plugins/livetype/.r/,
    Extension=.otf,
    UprightFont=.58300,
    Scale=1.0
]

% Header font - EB Garamond small caps
\newfontfamily\headerfont{EB Garamond}[
    Letters=SmallCaps,
    LetterSpace=6,
    Scale=1.0
]

% Small caps font for labels
\newfontfamily\scfont{EB Garamond}[
    Letters=SmallCaps,
    Scale=0.9
]

% Initials font for illuminated drop caps
\newfontfamily\initialsfont{EB Garamond Initials}[
    Scale=1.0
]

% Question text styling
\newcommand{\questiontextfont}{\itshape}

%% ============================================================
%% Drop Cap Configuration
%% ============================================================

\renewcommand{\LettrineTextFont}{}
\setcounter{DefaultLines}{2}

%% ============================================================
%% Content Macros
%% ============================================================

% Question counter
\newcounter{questionnum}

% Counter for uppercase Roman numerals
\newcounter{lordsdaynum}

% Lord's Day header - Title Case with small caps, uppercase Roman
% Usage: \lordsday{1}
\newcommand{\lordsday}[1]{%
    \setcounter{lordsdaynum}{#1}%
    \nopagebreak[4]%
    \vspace{0.8em}%
    \begin{center}%
        \nopagebreak[4]%
        {\headerfont\fontsize{20pt}{24pt}\selectfont Lord's Day \Roman{lordsdaynum}}%
    \end{center}%
    \nopagebreak[4]%
    \vspace{0.4em}%
    \nopagebreak[4]%
}

% Question and Answer formatting with drop cap Q and A
% Usage: \catechismqa{1}{Question text}{Answer text}
\newcommand{\catechismqa}[3]{%
    \setcounter{questionnum}{#1}%
    \par\vspace{0.4em}%
    \nopagebreak[4]%
    % Question with drop cap Q and hanging indent
    \noindent\hspace{-0.4em}%
    \makebox[0pt][r]{\raisebox{-0.15em}{\initialsfont\fontsize{36pt}{36pt}\selectfont\color{gold}Q}\hspace{0.25em}}%
    {\scfont #1.}\hspace{0.3em}%
    {\questiontextfont #2}%
    \par\vspace{0.2em}%
    \nopagebreak[3]%
    % Answer with drop cap A and hanging indent
    \noindent\hspace{-0.4em}%
    \makebox[0pt][r]{\raisebox{-0.15em}{\initialsfont\fontsize{36pt}{36pt}\selectfont\color{gold}A}\hspace{0.3em}}%
    #3%
    \par%
}

% Scripture reference formatting
\newcommand{\scripture}[1]{%
    {\footnotesize\itshape #1}%
}

% Section divider (simple)
\newcommand{\sectiondivider}{%
    \vspace{0.5em}%
    \begin{center}%
        \rule{2in}{0.4pt}%
    \end{center}%
    \vspace{0.5em}%
}

%% ============================================================
%% Text Spacing for Large Format
%% ============================================================

% Generous line spacing for poster readability
\setstretch{1.15}

% Paragraph settings
\setlength{\parindent}{0em}
\setlength{\parskip}{0.2em plus 0.1em minus 0.05em}

\endinput
